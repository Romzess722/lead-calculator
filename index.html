<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arbitrage ROI Calculator Pro</title>
    <style>
        :root {
            --primary: #8e44ad;
            --primary-dark: #7d3c98;
            --bg: #f5f6fa;
            --text: #2f3640;
            --card: #ffffff;
            --success: #27ae60;
            --danger: #e74c3c;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            display: flex;
            justify-content: center;
            padding: 20px;
            margin: 0;
        }

        .container {
            background: var(--card);
            width: 100%;
            max-width: 420px;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }

        h2 {
            text-align: center;
            color: var(--primary);
            margin-bottom: 25px;
            font-weight: 800;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-size: 11px;
            font-weight: bold;
            color: #7f8c8d;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        input, select {
            padding: 12px;
            border: 2px solid #eee;
            border-radius: 10px;
            font-size: 15px;
            outline: none;
            transition: all 0.3s ease;
            background-color: #f9f9f9;
        }

        input:focus, select:focus {
            border-color: var(--primary);
            background-color: #fff;
            box-shadow: 0 0 0 4px rgba(142, 68, 173, 0.1);
        }

        /* Головні показники */
        .main-stats {
            background: var(--primary);
            color: white;
            padding: 20px;
            border-radius: 15px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(142, 68, 173, 0.3);
        }

        .stat-box h3 { 
            margin: 0; 
            font-size: 22px; 
            font-weight: 700;
        }

        .stat-box p { 
            margin: 5px 0 0; 
            font-size: 11px; 
            opacity: 0.9;
            text-transform: uppercase;
        }

        .divider {
            border-left: 1px solid rgba(255,255,255,0.2);
        }

        /* Таблиця */
        .table-title {
            font-size: 13px;
            font-weight: bold;
            margin: 20px 0 10px;
            color: var(--text);
            display: block;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
        }

        th {
            background: #f8f9fa;
            color: #7f8c8d;
            padding: 10px;
            font-size: 12px;
            text-align: left;
            border-bottom: 2px solid #eee;
        }

        td {
            padding: 12px 10px;
            border-bottom: 1px solid #eee;
            font-size: 14px;
        }

        .roi-percent {
            font-weight: bold;
            color: var(--primary);
        }

        .positive { color: var(--success); font-weight: bold; }
        .negative { color: var(--danger); font-weight: bold; }

        .footer-note {
            font-size: 10px;
            color: #bdc3c7;
            text-align: center;
            margin-top: 20px;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>Media Buying Calculate</h2>

    <div class="grid">
        <div class="input-group">
            <label>Валюта</label>
            <select id="currency">
                <option value="$">USD ($)</option>
                <option value="₴">UAH (₴)</option>
                <option value="€">EUR (€)</option>
                <option value="zł">PLN (zł)</option>
            </select>
        </div>
        <div class="input-group">
            <label>% Апруву</label>
            <select id="approval"></select>
        </div>
        <div class="input-group">
            <label>CPA (Виплата)</label>
            <input type="number" id="payout" placeholder="0.00" step="0.1">
        </div>
        <div class="input-group">
            <label>Твоя ціна ліда</label>
            <input type="number" id="cpl" placeholder="0.00" step="0.1">
        </div>
    </div>

    <div class="main-stats">
        <div class="stat-box">
            <h3 id="limit-price">0.00</h3>
            <p>Гранична ціна</p>
        </div>
        <div class="stat-box divider">
            <h3 id="current-roi">0%</h3>
            <p>ROI</p>
        </div>
    </div>

    <span class="table-title">Цільова ціна ліда (CPL) при:</span>
    <table>
        <thead>
            <tr>
                <th>ROI %</th>
                <th>Ціна ліда</th>
            </tr>
        </thead>
        <tbody id="roi-table-body">
            </tbody>
    </table>

    <p class="footer-note">Дані зберігаються автоматично</p>
</div>

<script>
    const approvalSelect = document.getElementById('approval');
    const payoutInput = document.getElementById('payout');
    const cplInput = document.getElementById('cpl');
    const currencySelect = document.getElementById('currency');

    // 1. Наповнюємо список апруву від 1 до 100
    function initApproval() {
        for (let i = 1; i <= 100; i++) {
            const opt = document.createElement('option');
            opt.value = i;
            opt.textContent = i + '%';
            approvalSelect.appendChild(opt);
        }
    }

    // 2. Збереження та завантаження даних (localStorage)
    function loadSavedData() {
        payoutInput.value = localStorage.getItem('payout') || 18;
        cplInput.value = localStorage.getItem('cpl') || 2.5;
        currencySelect.value = localStorage.getItem('currency') || '$';
        approvalSelect.value = localStorage.getItem('approval') || 16;
    }

    function saveData() {
        localStorage.setItem('payout', payoutInput.value);
        localStorage.setItem('cpl', cplInput.value);
        localStorage.setItem('currency', currencySelect.value);
        localStorage.setItem('approval', approvalSelect.value);
    }

    // 3. Основна логіка розрахунку
    function calculate() {
        const apr = parseFloat(approvalSelect.value) / 100;
        const payout = parseFloat(payoutInput.value) || 0;
        const myCpl = parseFloat(cplInput.value) || 0;
        const curr = currencySelect.value;

        // Гранична ціна ліда (Break-even)
        const limitPrice = payout * apr;
        document.getElementById('limit-price').textContent = curr + limitPrice.toFixed(2);

        // Поточний ROI
        const roiEl = document.getElementById('current-roi');
        if (myCpl > 0) {
            const currentRoi = ((limitPrice - myCpl) / myCpl) * 100;
            roiEl.textContent = currentRoi.toFixed(1) + '%';
            roiEl.style.color = currentRoi >= 0 ? '#fff' : '#ff9f9f'; // Підсвітка тексту в картці
        } else {
            roiEl.textContent = '0%';
        }

        // Таблиця цільового ROI (згідно твого скріншоту: 100%, 50%, 25%, 10%, 40%)
        const targetRois = [100, 50, 40, 25, 10];
        const tbody = document.getElementById('roi-table-body');
        tbody.innerHTML = '';

        targetRois.forEach(roi => {
            const targetCpl = limitPrice / (1 + (roi / 100));
            const row = `<tr>
                <td class="roi-percent">${roi}%</td>
                <td><b>${curr}${targetCpl.toFixed(2)}</b></td>
            </tr>`;
            tbody.innerHTML += row;
        });

        saveData();
    }

    // Слухачі подій
    [approvalSelect, payoutInput, cplInput, currencySelect].forEach(el => {
        el.addEventListener('input', calculate);
    });

    // Запуск
    initApproval();
    loadSavedData();
    calculate();
</script>

</body>
</html>

